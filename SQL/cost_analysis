--Gathering eBay listings data
CREATE TABLE ebay_all_listings_08152024 (
	title text,
	custom_label text,
	available_quantity smallint,
	start_price float,
	current_price float,
	sold_quantity smallint,
	start_date timestamp,
	condition text
);

COPY public.ebay_all_listings_08152024
FROM 'C:\Users\Public\eBay all listings 08152024.csv'
CSV HEADER;

SELECT *
FROM public.ebay_all_listings_08152024;

--Gathering eBay sales and costs data
CREATE TABLE ebay_fees_and_proceeds_july (
	listing_title text,
	quantity_sold smallint,
	item_sales float,
	total_selling_costs float,
	shipping_labels_cost float,
	average_selling_price float
);

COPY public.ebay_fees_and_proceeds_july
FROM 'C:\Users\Public\ebay_fees_and_proceeds_july.csv'
CSV HEADER;

SELECT *
FROM public.ebay_fees_and_proceeds_july;

--Gathering Amazon sales and costs data 
CREATE TABLE amazon_fees_and_proceeds_july (
	asin text,
	refferal_fee_total float,
	net_proceeds_total float
);

COPY public.amazon_fees_and_proceeds_july
FROM 'C:\Users\Public\amazon_fees_and_proceeds_july.csv'
CSV HEADER;

SELECT *
FROM public.amazon_fees_and_proceeds_july;

CREATE TABLE amazon_shipping_costs_july (
	amazon_order_id text,
	merchant_order_id text,
	purchase_date text,
	last_updated_date text,
	order_status text,
	fulfillment_channel text,
	sales_channel text,
	order_channel text,
	url text,
	ship_service_level text,
	product_name text,
	sku text,
	asin text,
	item_status text,
	quantity smallint,
	currency text,
	item_price float,
	item_tax float,
	shipping_price float,
	shipping_tax float,
	gift_wrap_price float,
	gift_wrap_tax float,
	item_promotion_discount text,
	ship_promotion_discount text,
	ship_city text,
	ship_state text,
	ship_postal_code text,
	ship_country text,
	promotion_ids text,
	cpf text,
	is_business_order text,
	purchase_order_number text,
	price_designation text,
	signature_confirmation_recommended text
	);

COPY public.amazon_shipping_costs_july
FROM 'C:\Users\Public\amazon_shipping_costs_july.csv'
CSV HEADER;





--Calculate shipping costs on amazon
SELECT COUNT(DISTINCT amazon_order_id) * 7 --average cost to ship (approximation)
FROM public.amazon_shipping_costs_july;


